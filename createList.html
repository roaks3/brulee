<head>
    <link rel="stylesheet" type="text/css" href="createList.css" />
    <script type="text/javascript" src="js/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="js/ingredient.js"></script>
    <script type="text/javascript">

        var allRecipes = new Recipes();
        var recipeStore = new ElasticSearchRecipeStore();
        
        $(document).ready(function() {

            recipeStore.getAllRecipes(function(recipes) {
                for (var i = 0; i < recipes.size(); i++) {
                    var recipeName = recipes.get(i).getName();
                    $("#recipes").append("<input type='checkbox' name='recipes' value='" + recipeName + "' /> " + recipeName + "<br />");
                }
                allRecipes = recipes;
            });

            $("#createListButton").click(function() {
                // go through each checked check box and accumulate the ingredients of those recipes
                var allIngredients = new Ingredients();
                $("input:checkbox").each(function() {
                    if ($(this).is(":checked")) {
                        var recipeName = $(this).attr("value");
                        var recipe = allRecipes.getByName(recipeName);
                        var ingredients = new Ingredients();
                        ingredients.addAll(recipe.getIngredients());
                        allIngredients.combineAll(ingredients);
                    }
                });

                for (var i = 0; i < allIngredients.size(); i++) {
                    $("#ingredients").append(allIngredients.get(i)._amount + " - " + allIngredients.get(i)._item + "<br />");
                }
            });
        });

    </script>
    
    <title>
        Create Shopping List
    </title>
</head>

<div id="recipes"></div>
<div id="list">
    <button id="createListButton">Create Shopping List</button>
    <div id="ingredients"></div>
</div>
